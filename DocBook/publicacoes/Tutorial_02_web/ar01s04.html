<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>4. Relacionamentos</title><meta name="generator" content="DocBook XSL-NS Stylesheets V1.74.0"><link rel="home" href="index.html" title="Estruturando o Banco de Dados"><link rel="up" href="index.html" title="Estruturando o Banco de Dados"><link rel="prev" href="ar01s03.html" title="3. Tabelas"><link rel="next" href="ar01s05.html" title="5. Planejamento de Formul&aacute;rio Proveniente de Tabela &Uacute;nica"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">4. Relacionamentos</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="ar01s03.html">Anterior</a>&nbsp;</td><th width="60%" align="center">&nbsp;</th><td width="20%" align="right">&nbsp;<a accesskey="n" href="ar01s05.html">Pr&oacute;ximo</a></td></tr></table><hr></div><div class="section" lang="pt"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e292"></a>4. Relacionamentos</h2></div></div></div><p>Relacionamento &eacute; assunto j&aacute; abordado no 1&ordm; Tutorial, vamos aqui
    nos concentrar em como implementar os relacionamentos no MS Access.</p><p>No menu principal, selecione <span class="guimenu">Ferramentas</span> &gt;
    <span class="guisubmenu">Relacionamentos</span>...</p><p>Ao abrir, o MS Access oferece a oportunidade de voc&ecirc; dizer
    quais tabelas quer relacionar; se a mensagem n&atilde;o aparece, clique no
    bot&atilde;o <span class="emphasis"><em>mostrar tabela</em></span> <span class="inlinemediaobject"><img src="images/botao_mostrar_tabela.gif"></span> e adicione as tr&ecirc;s tabelas:
    <span class="emphasis"><em>Contribuintes</em></span>, <span class="emphasis"><em>Ecf</em></span> e
    <span class="emphasis"><em>ArquivoAutenticado</em></span>.</p><div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Tip"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Dica]" src="images/tip.gif"></td><th align="left">Dica</th></tr><tr><td align="left" valign="top"><p>Mantenha SHIFT pressionado enquanto seleciona as tabelas; depois
      pressione <span class="guibutton">Adicionar</span>.</p></td></tr></table></div><p>Distribua as tabelas de acordo com a figura abaixo:</p><div class="figure"><a name="d0e331"></a><p class="title"><b>Figura 5. Relacionamento entre as tabelas</b></p><div class="figure-contents"><div class="mediaobject" align="center"><img src="images/t_02_04.bmp" align="middle" alt="Relacionamento entre as tabelas"></div></div></div><p><br class="figure-break"></p><div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Tip"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Dica]" src="images/tip.gif"></td><th align="left">Dica</th></tr><tr><td align="left" valign="top"><p>Para arrastar as tabelas, posicione o cursor no cabe&ccedil;alho de
        cada tabela e com o bot&atilde;o direito do mouse pressionado, arraste
        todo o conjunto; observamos que essa ditribui&ccedil;&atilde;o &eacute; meramente
        est&eacute;tica.</p></td></tr></table></div><p>Selecione o campo <span class="guimenuitem">CodigoContribuinte</span> da
    tabela <span class="emphasis"><em>Contribuinte</em></span> e arraste-o at&eacute; o campo de mesmo
    nome da tabela <span class="emphasis"><em>ArquivoAutenticado</em></span>; libere o
    <span class="emphasis"><em>mouse</em></span>.</p><p>Selecione o campo <span class="guimenuitem">CodigoEcf</span> da tabela
    <span class="emphasis"><em>Ecf</em></span> e arraste-o at&eacute; o campo de mesmo nome da tabela
    <span class="emphasis"><em>ArquivoAutenticado</em></span>; libere o
    <span class="emphasis"><em>mouse</em></span>.</p><div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Tip"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Dica]" src="images/tip.gif"></td><th align="left">Dica</th></tr><tr><td align="left" valign="top"><p>A movimenta&ccedil;&atilde;o deve ser feita sempre da tabela prim&aacute;ria para
      a tabela relacionada.</p></td></tr></table></div><p>Agora vamos impor a <a class="link" href="go01.html#integridade_referencial" title="Integridade Referencial">integridade referencial</a> :</p><p>Selecione a linha do relacionamento Contribuinte X
    ArquivoAutenticado, e clique com o bot&atilde;o direito do mouse, para
    edit&aacute;-lo, conforme abaixo ilustrado:</p><div class="figure"><a name="d0e378"></a><p class="title"><b>Figura 6. </b></p><div class="figure-contents"><div class="mediaobject" align="center"><img src="images/t_02_39.bmp" align="middle"></div></div></div><br class="figure-break"><p>Selecione Impor integridade referencial, Propagar atualiza&ccedil;&otilde;es
    dos campos relacionados e Propagar exclus&atilde;o dos registros
    relacionados, conforme abaixo:</p><div class="figure"><a name="d0e384"></a><p class="title"><b>Figura 7. Imposi&ccedil;&atilde;o da Integridade Referencial na rela&ccedil;&atilde;o
      Contribuinte X ArquivoAutenticado</b></p><div class="figure-contents"><div class="mediaobject" align="center"><img src="images/t_02_05.bmp" align="middle" alt="Imposi&ccedil;&atilde;o da Integridade Referencial na rela&ccedil;&atilde;o Contribuinte X ArquivoAutenticado"></div></div></div><br class="figure-break"><p></p><p>Proceda da mesma forma na rela&ccedil;&atilde;o entre as tabelas
    <span class="emphasis"><em>ArquivoAutenticado</em></span> X <span class="emphasis"><em>Ecf</em></span>,
    impondo a i<span class="emphasis"><em>ntegridade referencial e propaga&ccedil;&otilde;es das
    atualiza&ccedil;&otilde;es e exclus&otilde;es,</em></span> conforme figura
    abaixo:</p><div class="figure"><a name="d0e402"></a><p class="title"><b>Figura 8. Imposi&ccedil;&atilde;o da Integridade referencial na rela&ccedil;&atilde;o Ecf X
        ArquivoAutenticado</b></p><div class="figure-contents"><div class="mediaobject" align="center"><img src="images/t_02_07.bmp" align="middle" alt="Imposi&ccedil;&atilde;o da Integridade referencial na rela&ccedil;&atilde;o Ecf X ArquivoAutenticado"></div></div></div><p><br class="figure-break"></p><p>Salve <span class="inlinemediaobject"><img src="images/botao_salvar.gif"></span> e feche a janela
    <span class="guimenuitem">Relacionamentos</span>.</p><p>(Quanto ao termo <a class="link" href="ar01s04.html#fig_integridade">Integridade
    referencial</a>, confira no gloss&aacute;rio e o quadro logo abaixo)</p><div class="figure"><a name="d0e422"></a><p class="title"><b>Figura 9. Explica&ccedil;&atilde;o do significado da imposi&ccedil;&atilde;o da integridade
      referencial</b></p><div class="figure-contents"><div class="mediaobject" align="center"><img src="images/t_02_06.bmp" align="middle" alt="Explica&ccedil;&atilde;o do significado da imposi&ccedil;&atilde;o da integridade referencial"></div></div></div><br class="figure-break"></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="ar01s03.html">Anterior</a>&nbsp;</td><td width="20%" align="center">&nbsp;</td><td width="40%" align="right">&nbsp;<a accesskey="n" href="ar01s05.html">Pr&oacute;ximo</a></td></tr><tr><td width="40%" align="left" valign="top">3. Tabelas&nbsp;</td><td width="20%" align="center"><a accesskey="h" href="index.html">In&iacute;cio</a></td><td width="40%" align="right" valign="top">&nbsp;5. Planejamento de Formul&aacute;rio Proveniente de Tabela &Uacute;nica</td></tr></table></div></body></html>