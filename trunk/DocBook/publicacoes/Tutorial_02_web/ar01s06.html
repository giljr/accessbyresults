<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>6. Implementa&ccedil;&atilde;o da Consulta &agrave; M&uacute;ltiplas Tabelas</title><meta name="generator" content="DocBook XSL-NS Stylesheets V1.74.0"><link rel="home" href="index.html" title="Estruturando o Banco de Dados"><link rel="up" href="index.html" title="Estruturando o Banco de Dados"><link rel="prev" href="ar01s05.html" title="5. Planejamento de Formul&aacute;rio Proveniente de Tabela &Uacute;nica"><link rel="next" href="ar01s07.html" title="7. Implementa&ccedil;&atilde;o do Formul&aacute;rio para Confec&ccedil;&atilde;o do Relat&oacute;rio"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">6. Implementa&ccedil;&atilde;o da Consulta &agrave; M&uacute;ltiplas Tabelas</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="ar01s05.html">Anterior</a>&nbsp;</td><th width="60%" align="center">&nbsp;</th><td width="20%" align="right">&nbsp;<a accesskey="n" href="ar01s07.html">Pr&oacute;ximo</a></td></tr></table><hr></div><div class="section" lang="pt"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e566"></a>6. Implementa&ccedil;&atilde;o da Consulta &agrave; M&uacute;ltiplas Tabelas</h2></div></div></div><p>Podemos pensar nas consultas como se fossem tabelas virtuais.</p><p>Depois de executar uma consulta, o MS Access coleta os dados
    procurados em um <a class="link" href="go01.html#dynaset" title="Dynaset">dynaset</a>.</p><p>Um <a class="link" href="go01.html#dynaset" title="Dynaset">dynaset</a> se comporta como uma
    tabela; &eacute; uma visualiza&ccedil;&atilde;o din&acirc;mica dos dados de uma ou mais tabelas,
    selecionados e classificados como especificado pela consulta; vamos a um
    exemplo:</p><p>Para chegarmos ao nosso objetivo (imprimir o T<span class="emphasis"><em>ermo de
    Autentica&ccedil;&atilde;o</em></span>), necessitamos fazer uma consulta &agrave;s
    tr&ecirc;s tabelas especificadas.</p><p>Vamos apresentar a t&eacute;cnica para se fazer uma consulta &agrave;
    m&uacute;ltiplas tabelas (usaremos essa consulta no relat&oacute;rio).</p><div class="orderedlist"><ol type="1"><li><p>Na aba <span class="guimenuitem">Consultas</span>, v&aacute; ao menu
        principal, clique no bot&atilde;o novo <span class="inlinemediaobject"><img src="images/botao_novo.gif"></span> e escolha <span class="guimenuitem">Assistente de consulta
        simples</span>;</p><div class="figure"><a name="d0e602"></a><p class="title"><b>Figura 11. </b></p><div class="figure-contents"><div class="mediaobject" align="center"><img src="images/t_02_08.bmp" align="middle"></div></div></div><p><br class="figure-break"></p></li><li><p>Na caixa de op&ccedil;&otilde;es, selecione <span class="guimenuitem">Tabela:
        Contribuinte</span>, transfira os campos
        <span class="guimenuitem">Rs</span>, <span class="guimenuitem">Ie</span>,
        <span class="guimenuitem">Cnpj</span>, <span class="guimenuitem">End</span>,
        <span class="guimenuitem">Municipio</span> e <span class="guimenuitem">Uf</span>
        para o espa&ccedil;o <span class="guilabel">Campos selecionados</span>; use o
        bot&atilde;o transfere-um-a-um <span class="inlinemediaobject"><img src="images/botao_avanca_um.gif"></span> ; (mantenha-se na tela);</p><div class="figure"><a name="d0e637"></a><p class="title"><b>Figura 12. </b></p><div class="figure-contents"><div class="mediaobject" align="center"><img src="images/t_02_09.bmp" align="middle"></div></div></div><p><br class="figure-break"></p></li><li><p>Na mesma tela, selecione Tabela: <span class="emphasis"><em>Ecf</em></span> e
        insira os campos de <span class="guimenuitem">Marca</span>,
        <span class="guimenuitem">Modelo</span>,
        <span class="guimenuitem">NrVersao</span>,
        <span class="guimenuitem">NrFabricacao</span>; (mantenha-se na tela);</p><div class="figure"><a name="d0e659"></a><p class="title"><b>Figura 13. </b></p><div class="figure-contents"><div class="mediaobject" align="center"><img src="images/t_02_10.bmp" align="middle"></div></div></div><p><br class="figure-break"></p></li><li><p>Ainda na mesma tela, selecione a tabela
        <span class="emphasis"><em><span class="emphasis"><em>ArquivoAutenticado</em></span></em></span> e insira
        <span class="emphasis"><em>todos os campos</em></span> clicando no bot&atilde;o
        transfere-todos <span class="inlinemediaobject"><img src="images/botao_avanca_todos.gif"></span> ; ( agora pressione <span class="inlinemediaobject"><img src="images/botao_avancar.gif"></span> 2 X aceitando a configua&ccedil;&atilde;o
        padr&atilde;o)</p><div class="figure"><a name="d0e681"></a><p class="title"><b>Figura 14. </b></p><div class="figure-contents"><div class="mediaobject" align="center"><img src="images/t_02_11.bmp" align="middle"></div></div></div><p><br class="figure-break"></p></li><li><p>Nomeie a consulta como
        <span class="guimenuitem">ArquivoAutenticadoPorContribuinte_Consulta</span>
        e clique no bot&atilde;o concluir <span class="inlinemediaobject"><img src="images/botao_concluir.gif"></span> ;</p><div class="figure"><a name="d0e695"></a><p class="title"><b>Figura 15. </b></p><div class="figure-contents"><div class="mediaobject" align="center"><img src="images/t_02_12.bmp" align="middle"></div></div></div><p><br class="figure-break"></p><div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Tip"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Dica]" src="images/tip.gif"></td><th align="left">Dica</th></tr><tr><td align="left" valign="top"><p>Ao nomear os objetos, costumamos acrescentar, no final do
          nome, um identificador do tipo de objeto (para isso sufixamos o nome
          do objeto com _TipoDoObjeto); por exemplo, se relat&oacute;rio, sufixo
          _Relatorio, se consulta sufixo _Consulta...assim em diante; o motivo
          voc&ecirc; perceber&aacute; no transcorrer desse trabalho.</p></td></tr></table></div></li><li><p>O MS Access abre a consulta, em <a class="link" href="">dynaset</a>, conforme figura abaixo (se n&atilde;o
        houver dado plotado, o dynaset aparece em branco, indicando nulo o
        retorno); agora, feche a janela, clicando no bot&atilde;o fechar
        <span class="inlinemediaobject"><img src="images/botao_fechar.gif"></span> ;</p><div class="figure"><a name="d0e713"></a><p class="title"><b>Figura 16. </b></p><div class="figure-contents"><div class="mediaobject" align="center"><img src="images/t_02_13.bmp" align="middle"></div></div></div><p><br class="figure-break"></p></li><li><p>Na aba consulta, selecione o objeto
        <span class="guimenuitem">ArquivoAutenticadoPorContribuinte_Consulta</span>,
        clique no botao estrutura <span class="inlinemediaobject"><img src="images/botao_design.gif"></span> , conforme indicado na figura:</p><div class="figure"><a name="d0e727"></a><p class="title"><b>Figura 17. </b></p><div class="figure-contents"><div class="mediaobject" align="center"><img src="images/t_02_17.bmp" align="middle"></div></div></div><br class="figure-break"></li><li><p>No modo Design (estrutura), na <a class="link" href=""><span class="emphasis"><em>grade QBE</em></span></a>, procure
        pelo campo <span class="guimenuitem">CodigoContribuinte</span> e proceda
        conforme indicado na figura abaixo, inserindo no campo <span class="guimenu">
        Crit&eacute;rios</span> a express&atilde;o : [Entre com o c&oacute;digo do
        contribuinte], dessa forma, entre colchetes;</p><p>Salve a consulta, clicando no bot&atilde;o salvar
        <span class="inlinemediaobject"><img src="images/botao_salvar.gif"></span> , no menu principal, feche a janela clicando em
        fechar <span class="inlinemediaobject"><img src="images/botao_fechar.gif"></span></p><p>Pronto! agora estamos prontos para seguirmos.</p><div class="figure"><a name="d0e755"></a><p class="title"><b>Figura 18. </b></p><div class="figure-contents"><div class="mediaobject" align="center"><img src="images/t_02_18.bmp" align="middle"></div></div></div><br class="figure-break"></li></ol></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="ar01s05.html">Anterior</a>&nbsp;</td><td width="20%" align="center">&nbsp;</td><td width="40%" align="right">&nbsp;<a accesskey="n" href="ar01s07.html">Pr&oacute;ximo</a></td></tr><tr><td width="40%" align="left" valign="top">5. Planejamento de Formul&aacute;rio Proveniente de Tabela &Uacute;nica&nbsp;</td><td width="20%" align="center"><a accesskey="h" href="index.html">In&iacute;cio</a></td><td width="40%" align="right" valign="top">&nbsp;7. Implementa&ccedil;&atilde;o do Formul&aacute;rio para Confec&ccedil;&atilde;o do
    Relat&oacute;rio</td></tr></table></div></body></html>